<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Create a session timeout in Symfony 1.4 | Ixartz’s technical blog</title> <meta name="generator" content="Jekyll v3.8.6"/> <meta property="og:title" content="Create a session timeout in Symfony 1.4"/> <meta name="author" content="Ixartz"/> <meta property="og:locale" content="en_US"/> <meta name="description" content="How to set a Symfony session lifetime. The default Symfony session expiration time is not suited to your use change? In this article, I’ll explain how you can increase it."/> <meta property="og:description" content="How to set a Symfony session lifetime. The default Symfony session expiration time is not suited to your use change? In this article, I’ll explain how you can increase it."/> <link rel="canonical" href="https://blog.ixartz.com/create-a-session-timeout-in-symfony-1-4/"/> <meta property="og:url" content="https://blog.ixartz.com/create-a-session-timeout-in-symfony-1-4/"/> <meta property="og:site_name" content="Ixartz’s technical blog"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2013-02-07T18:12:30+00:00"/> <script type="application/ld+json">
{"description":"How to set a Symfony session lifetime. The default Symfony session expiration time is not suited to your use change? In this article, I’ll explain how you can increase it.","author":{"@type":"Person","name":"Ixartz"},"@type":"BlogPosting","url":"https://blog.ixartz.com/create-a-session-timeout-in-symfony-1-4/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://blog.ixartz.com/assets/images/avatar.png"},"name":"Ixartz"},"headline":"Create a session timeout in Symfony 1.4","dateModified":"2019-01-13T14:38:19+00:00","datePublished":"2013-02-07T18:12:30+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.ixartz.com/create-a-session-timeout-in-symfony-1-4/"},"@context":"http://schema.org"}</script> <link rel="shortcut icon" href="/favicon.ico"> <link rel="stylesheet" href="/assets/css/style-fd671926271de12eaa76fa3cc6209199.css"> </head> <body> <nav class="main-nav"> <a href="/"> <span class="arrow">←</span>Home</a> <a href="/about/">About</a> <a class="cta" href="http://twitter.com/ixartz" target="_blank" rel="noopener noreferrer">Subscribe</a> </nav> <section class=" wrapper"> <article class="post"> <header> <h1>Create a session timeout in Symfony 1.4</h1> <h2 class="headline">February 7, 2013</h2> </header> <section id="post-body"> <p><img src="/assets/images/posts/hourglass.png" alt="The subject of this post" class="alignleft">I will begin by writing my first technical post on Symfony 1.4. I know 1.4 is obsolete (Symfony 2 have released and since November 2012, Symfony 1.x is not maintained anymore) but I am sure there is a lot of websites are currently running on Symfony 1.4. This post is my first and also the last one on 1.4 unless it has a huge success. I can still dream ;)</p> <h2 id="session-timeout-only-with-php">Session timeout only with PHP</h2> <h3 id="client-side">Client side</h3> <p><img src="/assets/images/posts/client.png" alt="Users around the world" class="alignright">In <em>php.ini</em> file, we can define a lifetime for sessions using cookies (the directive is named <em>session.cookie_lifetime</em>). So, we let the browsers manage the end of a session. Of course, browsers can delete cookie that stores session information when they want and not when we want. Moreover, today, browsers delete session cookie only when users close the window. So, it is a problem if you want to create a session timeout after some user’s inactivity time.</p> <h3 id="server-side">Server side</h3> <p><img src="/assets/images/posts/server.png" alt="A server which deliver pages" class="alignright">The other solution to create a session limited in time is to use another PHP directives, which change the session storage on server. Managing session timeout on server side has advantage of controlling session lifetime with <em>session.gc_maxlifetime</em>. Indeed, we no longer have to wait goodwill of browsers. By default, <em>session.gc_maxlifetime</em> is equal to 1 440 that is to say 24 minutes.</p> <p><img src="/assets/images/posts/php.gif" alt="The logo of PHP" class="alignleft">However, this does not mean that sessions are deleted after 1 440 seconds. In fact, <em>session.gc_probability</em> and <em>session.gc_divisor</em> are two important directives for the Garbage Collector (which deals with cleaning old session). The Garbage Collector is called with a probability of <em>session.gc_probability</em> divided by <em>session.gc_divisor</em>. Without changing anything, <em>session.gc_probability</em> (respectively <em>session.gc_divisor</em>) is equal to 1 (respectively equal to 100). So, there is 1/100% (1%) chance that the Garbage Collector cleans old session.</p> <h3 id="symfony-14">Symfony 1.4</h3> <p><img src="/assets/images/posts/symfony1.gif" alt="The logo of Symfony 1.x" class="alignright">This second solution has a disadvantage if we want all sessions to be deleted after a specific time of inactivity from the user. Of course, theoretically, we can set <em>session.gc_probability</em> and <em>session.gc_divisor</em> to 1. Nevertheless, launch the Garbage Collector on each request use resources unnecessarily.</p> <p>To solve this problem effectively, we will use Symfony settings. In <em>config/factories.yml</em>, we can add this few lines:</p> <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">all</span><span class="pi">:</span>
  <span class="na">user</span><span class="pi">:</span>
    <span class="na">class</span><span class="pi">:</span> <span class="s">myUser</span>
    <span class="na">param</span><span class="pi">:</span>
      <span class="na">timeout</span><span class="pi">:</span> <span class="s">1200</span></code></pre></figure> <p>You can replace 1 200 by everything you want. This number represents session lifetime in seconds. Unlike the two previous solutions, we are sure that users will be logout after a precise time of inactivity. Indeed, after 1 200 seconds of inactivity, <em>isAuthenticated()</em> will return <em>false</em> and we use this function to check if the user is connected or not. The <em>isAuthenticated()</em> function is implemented in <em>sfUser</em> class. So, inside the <em>view</em> layer, we use <em>$sf_user-&gt;isAuthenticated()</em> and in <em>controller</em>, we call <em>$this-&gt;getUser()-&gt;isAuthenticated()</em>.</p> <h2 id="conclusion">Conclusion</h2> <p><img src="/assets/images/posts/symfony2.png" alt="The logo of Symfony 2.x" class="alignright">Through this first post, I hope that you have learned something and this post will be useful to you.</p> </section> </article> <footer id="post-meta" class="clearfix"> <a href="http://twitter.com/ixartz" target="_blank" rel="noopener noreferrer"> <img class="avatar" src="/assets/images/avatar.png" alt="@ixartz"> <div> <span class="dark">Ixartz</span> <span>Sharing Engineering Stuff</span> </div> </a> <section id="sharing"> <a class="twitter" href="https://twitter.com/intent/tweet?text=http://https://blog.ixartz.com/create-a-session-timeout-in-symfony-1-4/%20-%20Create%20a%20session%20timeout%20in%20Symfony%201.4%20by%20@ixartz" target="_blank" rel="noopener noreferrer"><span class="icon-twitter"> Tweet</span></a> </section> </footer> <div class="archive readmore"> <h3>Comments</h3> <section class="disqus"> <div id="disqus_thread"></div> <script>
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');

    s.src = '//ixartz.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="noopener noreferrer" target="_blank">comments powered by Disqus.</a> </noscript> </section> </div> </section> <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-88747769-1', 'auto');
      ga('send', 'pageview');
    </script> </body> </html>