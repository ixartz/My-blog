<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Installing Threading Building Blocks (TBB) using MacPorts | Ixartz’s technical blog</title> <meta name="generator" content="Jekyll v3.8.6"/> <meta property="og:title" content="Installing Threading Building Blocks (TBB) using MacPorts"/> <meta name="author" content="Ixartz"/> <meta property="og:locale" content="en_US"/> <meta name="description" content="How to install TBB on Mac with MacPorts. Follow this guide for instructions on setting up Threading Building Blocks."/> <meta property="og:description" content="How to install TBB on Mac with MacPorts. Follow this guide for instructions on setting up Threading Building Blocks."/> <link rel="canonical" href="https://blog.ixartz.com/installing-threading-building-blocks-tbb-using-macports/"/> <meta property="og:url" content="https://blog.ixartz.com/installing-threading-building-blocks-tbb-using-macports/"/> <meta property="og:site_name" content="Ixartz’s technical blog"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2013-06-07T23:46:51+00:00"/> <script type="application/ld+json">
{"description":"How to install TBB on Mac with MacPorts. Follow this guide for instructions on setting up Threading Building Blocks.","author":{"@type":"Person","name":"Ixartz"},"@type":"BlogPosting","url":"https://blog.ixartz.com/installing-threading-building-blocks-tbb-using-macports/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://blog.ixartz.com/assets/images/avatar.png"},"name":"Ixartz"},"headline":"Installing Threading Building Blocks (TBB) using MacPorts","dateModified":"2019-01-13T14:38:19+00:00","datePublished":"2013-06-07T23:46:51+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.ixartz.com/installing-threading-building-blocks-tbb-using-macports/"},"@context":"http://schema.org"}</script> <link rel="shortcut icon" href="/favicon.ico"> <link rel="stylesheet" href="/assets/css/style-fd671926271de12eaa76fa3cc6209199.css"> </head> <body> <nav class="main-nav"> <a href="/"> <span class="arrow">←</span>Home</a> <a href="/about/">About</a> <a class="cta" href="http://twitter.com/ixartz" target="_blank" rel="noopener noreferrer">Subscribe</a> </nav> <section class=" wrapper"> <article class="post"> <header> <h1>Installing Threading Building Blocks (TBB) using MacPorts</h1> <h2 class="headline">June 7, 2013</h2> </header> <section id="post-body"> <p><img src="/assets/images/posts/tbb-large-product-plain.png" alt="C++ template library for task parallelism" class="alignright">Yesterday, I had to use Threading Building Blocks (TBB), an Intel C++ template library to take advantage of multicore processors. But, I had some troubles to create an executable and I had difficulty to find the solution on Internet. So, I write this thread in order to help futur users of TBB on Mac.</p> <h2 id="download-and-installation">Download and installation</h2> <p>After installing TBB library and its dependencies with the following command:</p> <figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">sudo </span>port <span class="nb">install </span>tbb</code></pre></figure> <p>I got no error messages and I thought everything worked. Indeed, g++ has not problems to find TBB headers. I could compile this code without trouble:</p> <figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="cp">#include &lt;iostream&gt;
#include "tbb/tick_count.h"
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">tbb</span><span class="o">::</span><span class="n">tick_count</span> <span class="n">t0</span> <span class="o">=</span> <span class="n">tbb</span><span class="o">::</span><span class="n">tick_count</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>

  <span class="c1">// Do something very long</span>

  <span class="n">tbb</span><span class="o">::</span><span class="n">tick_count</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">tbb</span><span class="o">::</span><span class="n">tick_count</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"time = %g seconds</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">).</span><span class="n">seconds</span><span class="p">());</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure> <figure class="highlight"><pre><code class="language-sh" data-lang="sh">g++ <span class="nt">-W</span> <span class="nt">-Wall</span> <span class="nt">-Wextra</span> <span class="nt">-Werror</span> <span class="nt">-pedantic</span> <span class="nt">-std</span><span class="o">=</span>c++11 main.cc</code></pre></figure> <h3 id="compilation-errors">Compilation errors</h3> <p><img src="/assets/images/posts/error.png" alt="A step-by-step guide for TBB" class="alignleft">Unfortunately, there are some errors which appears when we add <strong>-ltbb</strong> flag in previous command:</p> <figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="cp">#include "tbb/task_scheduler_init.h"
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">tbb</span><span class="o">::</span><span class="n">task_scheduler_init</span> <span class="n">init</span><span class="p">;</span>

  <span class="c1">// ...</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure> <figure class="highlight"><pre><code class="language-sh" data-lang="sh">g++ <span class="nt">-W</span> <span class="nt">-Wall</span> <span class="nt">-Wextra</span> <span class="nt">-Werror</span> <span class="nt">-pedantic</span> <span class="nt">-std</span><span class="o">=</span>c++11 <span class="nt">-ltbb</span> main.cc</code></pre></figure> <figure class="highlight"><pre><code class="language-sh" data-lang="sh">Undefined symbols <span class="k">for </span>architecture x86_64:
  <span class="s2">"tbb::task_scheduler_init::initialize(int, unsigned long)"</span>, referenced from:
      tbb::task_scheduler_init::task_scheduler_init<span class="o">(</span>int, unsigned long<span class="o">)</span> <span class="k">in </span>test.o
  <span class="s2">"tbb::task_scheduler_init::terminate()"</span>, referenced from:
      tbb::task_scheduler_init::~task_scheduler_init<span class="o">()</span> <span class="k">in </span>test.o
ld: symbol<span class="o">(</span>s<span class="o">)</span> not found <span class="k">for </span>architecture x86_64
collect2: error: ld returned 1 <span class="nb">exit </span>status</code></pre></figure> <p>This flag allows to load the library files (not only headers). So, if we can not compile with this flag, TBB would be very limited.</p> <h2 id="the-solution">The solution</h2> <p>In order to fix this error, type the following command:</p> <figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">source</span> /opt/local/bin/tbbvars.sh</code></pre></figure> <p>Now, you can execute the compilation command with <strong>-ltbb</strong> flag. I hope it helps you to save a lot of time. If you still have some error, leave a comment and I will try to help you. In few weeks, I will probably talk about TBB more deeply that is to say how I used it in video processing.</p> </section> </article> <footer id="post-meta" class="clearfix"> <a href="http://twitter.com/ixartz" target="_blank" rel="noopener noreferrer"> <img class="avatar" src="/assets/images/avatar.png" alt="@ixartz"> <div> <span class="dark">Ixartz</span> <span>Sharing Engineering Stuff</span> </div> </a> <section id="sharing"> <a class="twitter" href="https://twitter.com/intent/tweet?text=http://https://blog.ixartz.com/installing-threading-building-blocks-tbb-using-macports/%20-%20Installing%20Threading%20Building%20Blocks%20(TBB)%20using%20MacPorts%20by%20@ixartz" target="_blank" rel="noopener noreferrer"><span class="icon-twitter"> Tweet</span></a> </section> </footer> <div class="archive readmore"> <h3>Comments</h3> <section class="disqus"> <div id="disqus_thread"></div> <script>
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');

    s.src = '//ixartz.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="noopener noreferrer" target="_blank">comments powered by Disqus.</a> </noscript> </section> </div> </section> <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-88747769-1', 'auto');
      ga('send', 'pageview');
    </script> </body> </html>