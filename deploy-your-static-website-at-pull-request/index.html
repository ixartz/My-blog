<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Deploy your static website at every pull request | Ixartz’s technical blog</title> <meta name="generator" content="Jekyll v3.8.6"/> <meta property="og:title" content="Deploy your static website at every pull request"/> <meta name="author" content="Ixartz"/> <meta property="og:locale" content="en_US"/> <meta name="description" content="A guided tutorial to install Netlify on your JAMStack architecture. At the end the article, you’ll be able to use netlify as your GitHub CI and configure the netlify.toml file by yourself."/> <meta property="og:description" content="A guided tutorial to install Netlify on your JAMStack architecture. At the end the article, you’ll be able to use netlify as your GitHub CI and configure the netlify.toml file by yourself."/> <link rel="canonical" href="https://blog.ixartz.com/deploy-your-static-website-at-pull-request/"/> <meta property="og:url" content="https://blog.ixartz.com/deploy-your-static-website-at-pull-request/"/> <meta property="og:site_name" content="Ixartz’s technical blog"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2018-05-01T10:34:47+00:00"/> <script type="application/ld+json">
{"description":"A guided tutorial to install Netlify on your JAMStack architecture. At the end the article, you’ll be able to use netlify as your GitHub CI and configure the netlify.toml file by yourself.","author":{"@type":"Person","name":"Ixartz"},"@type":"BlogPosting","url":"https://blog.ixartz.com/deploy-your-static-website-at-pull-request/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://blog.ixartz.com/assets/images/avatar.png"},"name":"Ixartz"},"headline":"Deploy your static website at every pull request","dateModified":"2019-01-13T14:38:19+00:00","datePublished":"2018-05-01T10:34:47+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.ixartz.com/deploy-your-static-website-at-pull-request/"},"@context":"http://schema.org"}</script> <link rel="shortcut icon" href="/favicon.ico"> <link rel="stylesheet" href="/assets/css/style-fd671926271de12eaa76fa3cc6209199.css"> </head> <body> <nav class="main-nav"> <a href="/"> <span class="arrow">←</span>Home</a> <a href="/about/">About</a> <a class="cta" href="http://twitter.com/ixartz" target="_blank" rel="noopener noreferrer">Subscribe</a> </nav> <section class=" wrapper"> <article class="post"> <header> <h1>Deploy your static website at every pull request</h1> <h2 class="headline">May 1, 2018</h2> </header> <section id="post-body"> <p><em>In the article title, it is referring to a static site generator. Nevertheless, this tutorial can also be applied to your front-end code like React, Angular, etc.</em></p> <p>Pull request is part of GitHub flow. Other team members can review and comment on the changes. Today, everybody agrees that pull request improves code quality without any doubts. Unfortunately, displaying the source code is limited, you cannot see the change in real environment.</p> <p>The idea about this article is to deploy each pull request. After deploying it, you should be able to see it live in your browser. Other team members can also have access to it with one click. Of course, we do not want to alter the production version. So, the deployment happens without merging the pull request.</p> <h2 id="deploy-previews-review-apps">Deploy Previews, Review Apps</h2> <p>What we want to use is named <em>Deploy Previews</em> on <a href="https://www.netlify.com/" target="_blank" rel="noopener noreferrer">Netlify</a>. But, on <a href="https://www.heroku.com/" target="_blank" rel="noopener noreferrer">Heroku</a> or <a href="https://gitlab.com/" target="_blank" rel="noopener noreferrer">GitLab</a>, it has another name: <em>Review App</em>.</p> <p>Heroku is an application hosting, it is a little bit overkill to host only static files. In the opposite, GitLab can only host static pages for one branch. Currently, we cannot host several branches on GitLab Pages. It is possible to overcome this limitation but you need to link GitLab CI with a static hosting like <a href="https://surge.sh/" target="_blank" rel="noopener noreferrer">Surge</a>.</p> <h3 id="netlify-more-than-a-static-hosting-solution">Netlify more than a static hosting solution</h3> <p>Good news for us! Netlify has everything we need. First, we need to <a href="https://app.netlify.com/signup" target="_blank" rel="noopener noreferrer">create an account on Netlify</a>:</p> <p><img src="/assets/images/posts/netlify-static-hosting-sign-up.png" alt="Netlify sign up page" class="aligncenter"></p> <p>After signing up and logging into your account, you should see this page:</p> <p><img src="/assets/images/posts/netlify-create-new-site.png" alt="Netlify create a new site" class="aligncenter"></p> <p>There is a <em>New site from Git</em> button on the page, click on it and this following page will appear:</p> <p><img src="/assets/images/posts/netlify-github-link.png" alt="Netlify links with GitHub" class="aligncenter"></p> <p>Select your Git hosting service. In my case, I will choose GitHub. Then, you need to give Netlify access to your GitHub account.</p> <p><em>I will continue this tutorial on GitHub but the same principle can be applied to GitLab or Bitbucket.</em></p> <p>After authorizing Netlify, you need to select a project from your GitHub account:</p> <p><img src="/assets/images/posts/netlify-select-github-repository.png" alt="Netlify select a GitHub repository" class="aligncenter"></p> <p>Finally, you need to configure the building and deployment option:</p> <p><img src="/assets/images/posts/netlify-build-deploy-option.png" alt="Netlify configuration" class="aligncenter"></p> <p>The first option, <em>Branch to deploy</em>, is your main branch. In my case, the branch is <em>master</em>.</p> <p>The two other options are more related to the static site generator you use. The <em>build command</em> is the command to generate your website. For example, on Jekyll, it is <em>jekyll build</em>. And, the <em>publish directory</em> is the destination folder of your <em>build command</em>. Everything inside your <em>publish directory</em> will be served by Netlify.</p> <p>After submitting the form, Netlify will build your project and deploy it. When it finishes, you will see this screen:</p> <p><img src="/assets/images/posts/netlify-deployed-website.png" alt="Netlify deployed site" class="aligncenter"></p> <p>Click on the green link, you should see your site deployed.</p> <h3 id="behind-the-scene">Behind the scene</h3> <p>You do not need to do anything to make it work with a pull request. Netlify uses GitHub webhooks in order to be notified when someone creates a pull request.</p> <p><img src="/assets/images/posts/netlify-github-webhooks.png" alt="Netlify links Github webhooks" class="aligncenter"></p> <p>When a change is committed and pushed, Netlify can start a build and make the deployment.</p> <h3 id="configuring-netlifytoml-file">Configuring netlify.toml file</h3> <p>Configuring with UI, it is great but you do not have versioning. And, when someone forks your project, he needs to configure it again. The good news is that Netlify offers the configuration through <em>netlify.toml</em> file. Here is an example:</p> <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="pi">[</span><span class="nv">build</span><span class="pi">]</span>
    <span class="s">publish = '_site/'</span>
    <span class="s">command = 'sh command for production environment'</span>

<span class="pi">[</span><span class="nv">context.deploy-preview</span><span class="pi">]</span>
    <span class="s">command = 'sh command for pull request environment'</span></code></pre></figure> <p><em>build</em> context is the default build configuration. There is another <em>deploy-preview</em> context related to the deployment from a pull request.</p> <p>In the above example, I want to launch two different build configurations whether it is a pull request or it is from any branches.</p> <h3 id="testing-create-a-pull-request">Testing, create a pull request</h3> <p>Now, you can test by making a pull request and you will see a new line in the status checks of your pull request:</p> <p><img src="/assets/images/posts/netlify-status-checks.png" alt="Netlify status checks" class="aligncenter"></p> <p>Click on the <em>Details</em> link and you will see your pull request deployed and your changes live in your browser. You can continue to work on your change by making new commits and pushing to the pull request, it will be automatically deployed again.</p> </section> </article> <footer id="post-meta" class="clearfix"> <a href="http://twitter.com/ixartz" target="_blank" rel="noopener noreferrer"> <img class="avatar" src="/assets/images/avatar.png" alt="@ixartz"> <div> <span class="dark">Ixartz</span> <span>Sharing Engineering Stuff</span> </div> </a> <section id="sharing"> <a class="twitter" href="https://twitter.com/intent/tweet?text=http://https://blog.ixartz.com/deploy-your-static-website-at-pull-request/%20-%20Deploy%20your%20static%20website%20at%20every%20pull%20request%20by%20@ixartz" target="_blank" rel="noopener noreferrer"><span class="icon-twitter"> Tweet</span></a> </section> </footer> <div class="archive readmore"> <h3>Comments</h3> <section class="disqus"> <div id="disqus_thread"></div> <script>
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');

    s.src = '//ixartz.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="noopener noreferrer" target="_blank">comments powered by Disqus.</a> </noscript> </section> </div> </section> <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-88747769-1', 'auto');
      ga('send', 'pageview');
    </script> </body> </html>